package com.zulrahhelper.options;

import com.sun.org.apache.xerces.internal.impl.dv.util.Base64;
import com.zulrahhelper.ImageOptions;
import com.zulrahhelper.ImageOrientation;
import com.zulrahhelper.Phase;
import org.junit.Assert;
import org.junit.Test;

import javax.imageio.ImageIO;
import java.awt.*;
import java.awt.image.BufferedImage;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.IOException;

import static com.zulrahhelper.options.Attack.*;

public class PhaseTest {
    @Test
    public void testGenerateImage() throws IOException {
        Phase phase = Phase
                .builder(Phase.Rotation.NORMAL, 2)
                .addAttack(NORMAL_10)
                .addAttack(VENOM_4)
                .addAttack(SNAKELING_4)
                .setMagePray()
                .setRangedPray()
                .build();

        ImageOptions opts = new ImageOptions();
        opts.setDarkMode(false);
        opts.setAttackIcons(true);
        opts.setPrayerIcons(true);
        opts.setOrientation(ImageOrientation.SOUTH);

        BufferedImage img = phase.getImage(opts);

        String imgBase64 = toBase64(img);
        File out = toFile(img);

        Desktop desktop = Desktop.getDesktop();
        desktop.open(out);
        Assert.assertEquals(img64, imgBase64);
    }

    // base64 -w 0 /tmp/applyToPhase.png | xclip -selection clipboard
    private static final String img64 = "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";

    private String toBase64(BufferedImage img) throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ImageIO.write(img, "png", baos);
        byte[] bytes = baos.toByteArray();
        return Base64.encode(bytes);
    }

    private File toFile(BufferedImage img) throws IOException {
        File out = new File("/tmp/applyToPhase.png");
        ImageIO.write(img, "png", out);
        return out;
    }
}
